p18 <- matrix(ncol = 15, nrow = 15)
p18[1,1] <- 75
p18[2,1:2] <- c(95, 64)
p18[3,1:3] <- c(17, 47, 82)
p18[4,1:4] <- c(18, 35, 87, 10)
p18[5,1:5] <- c(20, 04, 82, 47, 65)
p18[6,1:6] <- c(19, 01, 23, 75, 03, 34)
p18[7,1:7] <- c(88, 02, 77, 73, 07, 63, 67)
p18[8,1:8] <- c(99, 65, 04, 28, 06, 16, 70, 92)
p18[9,1:9] <- c(41, 41, 26, 56, 83, 40, 80, 70, 33)
p18[10,1:10] <- c(41, 48, 72, 33, 47, 32, 37, 16, 94, 29)
p18[11,1:11] <- c(53, 71, 44, 65, 25, 43, 91, 52, 97, 51, 14)
p18[12,1:12] <- c(70, 11, 33, 28, 77, 73, 17, 78, 39, 68, 17, 57)
p18[13,1:13] <- c(91, 71, 52, 38, 17, 14, 91, 43, 58, 50, 27, 29, 48)
p18[14,1:14] <- c(63, 66, 04, 68, 89, 53, 67, 30, 73, 16, 69, 87, 40, 31)
p18[15,1:15] <- c(04, 62, 98, 27, 23, 09, 70, 98, 73, 93, 38, 53, 60, 04, 23)

bruteus.forcus <- function(p18) {
  x<-0
  for (r2 in 1:2) {
    for (r3 in 1:2) {
      for (r4 in 1:2) {
        for (r5 in 1:2) {
          for (r6 in 1:2) {
            for (r7 in 1:2) {
              for (r8 in 1:2) {
                for (r9 in 1:2) {
                  for (r10 in 1:2) {
                    for (r11 in 1:2) {
                      for (r12 in 1:2) {
                        for (r13 in 1:2) {
                          for (r14 in 1:2) {
                            for (r15 in 1:2) {
                    x<-max(p18[1,1] 
                      + p18[2,r2] 
                      + p18[3,r3 + (r2-1)] 
                      + p18[4,r4 + (r3-1) + (r2-1)] 
                      + p18[5,r5 + (r4-1) + (r3-1)+ (r2-1)] 
                      + p18[6,r6 + (r5-1) + (r4-1)+ (r3-1)+ (r2-1)] 
                      + p18[7,r7 + (r6-1) + (r5-1)+ (r4-1)+ (r3-1)+ (r2-1)] 
                      + p18[8,r8 + (r7-1) + (r6-1)+ (r5-1)+ (r4-1)+ (r3-1)+ (r2-1)] 
                      + p18[9,r9  + (r8-1) + (r7-1)+ (r6-1)+ (r5-1)+ (r4-1)+ (r3-1)+ (r2-1)] 
                      + p18[10,r10 + (r9-1) + (r8-1)+ (r7-1)+ (r6-1)+ (r5-1)+ (r4-1)+ (r3-1)+ (r2-1)] 
                      + p18[11,r11 + (r10-1) + (r9-1)+ (r8-1)+ (r7-1)+ (r6-1)+ (r5-1)+ (r4-1)+ (r3-1)+ (r2-1)] 
                      + p18[12,r12 + (r11-1) + (r10-1) + (r9-1)+ (r8-1)+ (r7-1)+ (r6-1)+ (r5-1)+ (r4-1)+ (r3-1)+ (r2-1)] 
                      + p18[13,r13 + (r12-1) + (r11-1) + (r10-1) + (r9-1)+ (r8-1)+ (r7-1)+ (r6-1)+ (r5-1)+ (r4-1)+ (r3-1)+ (r2-1)] 
                      + p18[14,r14 + (r13-1) + (r12-1) + (r11-1)+ (r10-1)+ (r9-1)+ (r8-1)+ (r7-1)+ (r6-1)+ (r5-1)+ (r4-1)+ (r3-1)+ (r2-1)] 
                      + p18[15,r15 + (r14-1) + (r13-1) + (r12-1)+ (r11-1)+ (r10-1)+ (r9-1)+ (r8-1)+ (r7-1)+ (r6-1)+ (r5-1)+ (r4-1)+ (r3-1)+ (r2-1)],x)
                  }}}}}}}}}}}}}}
  return(x)
}

bruteus.forcus(p18)

##1074

